# web server
openresty:
  build: ./openresty
  ports:
    - "80:80"
    - "443:443"
  volumes:
    # app
    - /home/wwwroot:/usr/share/nginx/html
    # nginx configs
    - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    - ./nginx/conf.d/:/etc/nginx/conf.d/:ro
    # certificates
    # - ./nginx/ca/server.crt/:/etc/nginx/server.crt:ro
    # - ./nginx/ca/server.key/:/etc/nginx/server.key:ro
  links:
    - fpm:__DOCKER_PHP_FPM__

# php-fpm
fpm:
  build: ./php
  ports:
    - "9000"
  volumes:
    - ./app/src:/usr/share/nginx/html
    # Your php.ini
    - /home/config/php.ini:/usr/local/etc/php/php.ini:ro
  # environment:
    # Set your APP env variables here:
    # - APP_KEY=
    # - DB_HOST=
    # - DB_DATABASE=
    # - DB_USERNAME=
    # - DB_PASSWORD=
  links:
    - mysql:mysql

# database
mariadb:
  image: mariadb:latest
  ports:
    # Allow client to access 3306
    - "3306:3306"
  volumes:
    # NOTE: your data will be stored in ./mysql
    - /home/data/mariadb:/var/lib/mysql
  environment:
    - MYSQL_ROOT_PASSWORD=ibenchu123

pgsql:
  postgres:alphine
  ports:
    # Allow client to access 3306
    - "5432:5432"
  # volumes:
  volumes:
       - /home/data/pgsql:/var/lib/postgresql/data
  environment:
       - POSTGRES_PASSWORD=ibenchu123

redis:
    build: redis:latest
    posts:
    - "6379:6379"